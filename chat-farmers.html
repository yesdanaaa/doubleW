<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Farmers Community Chat</title>

  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: Arial, Helvetica, sans-serif;
      background: linear-gradient(to bottom, #eff6ff, #f0fdfa, #ecfdf5);
      min-height: 100vh;
      padding-bottom: 90px;
      color: #1f2937;
    }
    .header {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(8px);
      border-bottom: 1px solid #e5e7eb;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      position: sticky;
      top: 0;
      z-index: 10;
    }
    .header-inner {
      max-width: 500px;
      margin: 0 auto;
      padding: 12px 16px;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .back-btn {
      background: none;
      border: none;
      font-size: 24px;
      color: #4b5563;
      cursor: pointer;
      padding: 8px;
    }
    .header-info {
      flex: 1;
    }
    .header-title {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 1.125rem;
      font-weight: 600;
      color: #1f2937;
    }
    .online {
      font-size: 0.75rem;
      color: #6b7280;
    }
    .messages-container {
      max-width: 500px;
      margin: 16px auto;
      padding: 16px;
      min-height: calc(100vh - 180px);
    }
    .message {
      display: flex;
      margin-bottom: 16px;
      max-width: 80%;
    }
    .message.received {
      justify-content: flex-start;
    }
    .message.sent {
      justify-content: flex-end;
    }
    .message-inner {
      display: flex;
      gap: 8px;
      max-width: 100%;
    }
    .message.sent .message-inner {
      flex-direction: row-reverse;
    }
    .avatar {
      width: 32px;
      height: 32px;
      border-radius: 9999px;
      background: #d1fae5;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      flex-shrink: 0;
    }
    .bubble {
      padding: 10px 14px;
      border-radius: 18px;
      font-size: 0.95rem;
      line-height: 1.4;
    }
    .received .bubble {
      background: white;
      border-bottom-left-radius: 4px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .sent .bubble {
      background: #16a34a;
      color: white;
      border-bottom-right-radius: 4px;
    }
    .user-name {
      font-size: 0.75rem;
      color: #6b7280;
      margin-bottom: 4px;
    }
    .time {
      font-size: 0.6875rem;
      color: #9ca3af;
      margin-top: 4px;
    }
    .input-area {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(8px);
      border-top: 1px solid #e5e7eb;
      box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
      padding: 12px 16px;
    }
    .input-wrapper {
      max-width: 500px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    #messageInput {
      flex: 1;
      padding: 12px 16px;
      border: 1px solid #d1d5db;
      border-radius: 9999px;
      font-size: 1rem;
      outline: none;
    }
    #sendBtn {
      width: 44px;
      height: 44px;
      background: #16a34a;
      color: white;
      border: none;
      border-radius: 9999px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      cursor: pointer;
      transition: background 0.2s;
    }
    #sendBtn:disabled {
      background: #a3e635;
      cursor: not-allowed;
    }
    #sendBtn:active:not(:disabled) {
      transform: scale(0.95);
    }

    .bottom-nav {
      position: fixed;
      bottom: 64px;
      left: 0;
      right: 0;
      height: 64px;
      background: #2f8f5b;
      display: flex;
      justify-content: space-around;
      align-items: center;
      box-shadow: 0 -2px 10px rgba(0,0,0,0.15);
      z-index: 5;
    }
    .nav-item {
      color: white;
      text-decoration: none;
      padding: 8px 16px;
      border-radius: 12px;
      display: flex;
      align-items: center;
    }
    .nav-item i {
      font-size: 28px;
    }
    .nav-item.active {
      background: rgba(255,255,255,0.2);
    }
  </style>
</head>
<body>

  <div class="header">
    <div class="header-inner">
      <button class="back-btn" onclick="window.location.href='chat.html'">
        <i class="bx bx-arrow-back"></i>
      </button>
      <div class="header-info">
        <div class="header-title">
          <i class="bx bx-group" style="color: #16a34a; font-size: 20px;"></i>
          Farmers Community
        </div>
        <div class="online">127 members online</div>
      </div>
    </div>
  </div>

  <div class="messages-container" id="messages"></div>

  <div class="input-area">
    <div class="input-wrapper">
      <input 
        type="text" 
        id="messageInput" 
        placeholder="Type a message..." 
        autocomplete="off"
      >
      <button id="sendBtn" disabled>
        <i class="bx bx-send"></i>
      </button>
    </div>
  </div>

  <div class="bottom-nav">
    <a href="frontend.html" class="nav-item">
      <i class='bx bx-home'></i>
    </a>
    <a href="chat.html" class="nav-item active">
      <i class='bx bx-chat'></i>
    </a>
    <a href="account.html" class="nav-item">
      <i class='bx bx-user'></i>
    </a>
  </div>

  <script>
    const messagesEl = document.getElementById('messages');
    const input = document.getElementById('messageInput');
    const sendBtn = document.getElementById('sendBtn');

    let messages = JSON.parse(localStorage.getItem('farmersChat')) || [
      {
        user: 'Sarah M.',
        avatar: 'ðŸ‘©â€ðŸŒ¾',
        text: "Just finished irrigating my wheat fields. Used 15mm/mÂ² today.",
        time: '10:23 AM',
        sent: false
      },
      {
        user: 'John D.',
        avatar: 'ðŸ‘¨â€ðŸŒ¾',
        text: 'Has anyone tried the drip irrigation method? Thinking about switching.',
        time: '10:45 AM',
        sent: false
      },
      {
        user: 'Maria L.',
        avatar: 'ðŸ‘©â€ðŸŒ¾',
        text: "Yes! It saves so much water. Cut my usage by 40% last season.",
        time: '11:02 AM',
        sent: false
      }
    ];

    function renderMessages() {
      messagesEl.innerHTML = '';
      messages.forEach(msg => {
        const messageDiv = document.createElement('div');
        messageDiv.className = `message ${msg.sent ? 'sent' : 'received'}`;

        messageDiv.innerHTML = `
          <div class="message-inner">
            <div class="avatar">${msg.avatar}</div>
            <div>
              ${!msg.sent ? `<div class="user-name">${msg.user}</div>` : ''}
              <div class="bubble">${msg.text}</div>
              <div class="time">${msg.time}</div>
            </div>
          </div>
        `;

        messagesEl.appendChild(messageDiv);
      });
      messagesEl.scrollTop = messagesEl.scrollHeight;
    }

    function sendMessage() {
      const text = input.value.trim();
      if (!text) return;

      const now = new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
      const userName = localStorage.getItem('userName') || 'You';

      messages.push({
        user: userName,
        avatar: 'ðŸ§‘â€ðŸŒ¾',
        text,
        time: now,
        sent: true
      });

      localStorage.setItem('farmersChat', JSON.stringify(messages));
      input.value = '';
      sendBtn.disabled = true;
      renderMessages();
    }
    sendBtn.onclick = sendMessage;

    input.oninput = () => {
      sendBtn.disabled = !input.value.trim();
    };

    input.onkeypress = (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
      }
    };
    renderMessages();
  </script>

</body>
</html>